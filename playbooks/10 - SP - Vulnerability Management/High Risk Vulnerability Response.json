{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "High Risk Vulnerability Response",
    "aliasName": null,
    "tag": null,
    "description": "Creates a manual input step to take confirmation on resolution of all the vulnerabilities for the asset",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/d99a8b59-a957-4d95-ac1c-da59ec91a117",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/a0ab3aa4-242a-4847-982b-fcf3d92bb56d",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "alertID": "{{vars.input.records[0].id}}",
                "alertIRI": "{{vars.input.records[0]['@id']}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "4c594e1e-9a24-49cd-b625-7f72bc1768f8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Confirm Vulnerability Status",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Confirm Vulnerability Status",
                        "description": "### Asset Details\n**Asset IP**: {{vars.assetIP}}\n**Asset Hostname**: {{vars.assetHostname}}\n<br>\n<span style=\"font-size: 15px;\">Confirm that all the vulnerabilities mentioned in alert description for the asset has been resolved.<\/span>\n\n",
                        "inputVariables": [
                            {
                                "name": "closureNotes",
                                "type": "string",
                                "label": "Closure Notes",
                                "tooltip": "",
                                "dataType": "text",
                                "formType": "text",
                                "required": true,
                                "_expanded": false,
                                "defaultValue": null,
                                "_previousName": "closureNote",
                                "jinjaExpressionView": true,
                                "useRecordFieldDefault": false
                            },
                            {
                                "name": "closureReason",
                                "type": "picklists",
                                "label": "Closure Reason",
                                "title": "Picklist",
                                "usable": true,
                                "tooltip": "",
                                "dataType": "picklist",
                                "formType": "picklist",
                                "required": true,
                                "_expanded": false,
                                "mmdUpdate": true,
                                "collection": false,
                                "dataSource": {
                                    "model": "picklists",
                                    "query": {
                                        "sort": [
                                            {
                                                "field": "orderIndex",
                                                "direction": "ASC"
                                            }
                                        ],
                                        "logic": "AND",
                                        "filters": [
                                            {
                                                "field": "listName__name",
                                                "value": "Closure Reason",
                                                "operator": "eq"
                                            }
                                        ]
                                    },
                                    "displayConditions": {
                                        "2ab3e8e9-8cd9-4641-8400-a18a4e8a2da8": {
                                            "conditions": null,
                                            "visibility": "visible"
                                        },
                                        "2b0112f6-4746-4dab-ada6-a8cd1e675572": {
                                            "conditions": null,
                                            "visibility": "visible"
                                        },
                                        "672aef13-a684-422e-be6c-15e10ec49915": {
                                            "conditions": null,
                                            "visibility": "visible"
                                        },
                                        "8590c81e-3307-4645-97f5-c3e1bec4e05a": {
                                            "conditions": null,
                                            "visibility": "visible"
                                        },
                                        "8f8ce378-df65-4231-85e3-0b8f25a04379": {
                                            "conditions": null,
                                            "visibility": "visible"
                                        },
                                        "cc2d6b59-62de-4cb6-93a2-bcce4250009d": {
                                            "conditions": null,
                                            "visibility": "visible"
                                        }
                                    }
                                },
                                "searchable": false,
                                "templateUrl": "app\/components\/form\/fields\/typeahead.html",
                                "defaultValue": null,
                                "_previousName": "",
                                "playbookField": true,
                                "displayTemplate": "%7B%7B%20itemValue%20%7D%7D",
                                "lengthConstraint": false,
                                "allowedEncryption": false,
                                "allowedGridColumn": true,
                                "jinjaExpressionView": true,
                                "useRecordFieldDefault": false
                            }
                        ]
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "All Vulnerabilities Resolved",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/7c09bd19-c688-4f5c-a586-c70f1ec83c53"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "6c240b3d-45e5-476b-a7a2-3a5f976cd391"
        },
        {
            "@type": "WorkflowStep",
            "name": "Find Assets Linked to Alert",
            "description": "Get Assets Linked to the Alert, and collect asset information such as Asset ID, IP Address and Hostname",
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "id",
                            "value": "{{vars.alertID}}",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ],
                    "__selectFields": [
                        "assets"
                    ]
                },
                "module": "alerts?$limit=30&$relationships=true",
                "checkboxFields": true,
                "step_variables": {
                    "assetID": "{{vars.result[0].assets[0].id}}",
                    "assetIP": "{{vars.result[0].assets[0].ip}}",
                    "assetIRI": "{{vars.result[0].assets[0]['@id']}}",
                    "assetHostname": "{{vars.result[0].assets[0].hostname}}"
                }
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "7b3cdfe7-78d7-49d2-b55d-e1242bb38c05"
        },
        {
            "@type": "WorkflowStep",
            "name": "Unlink Asset Vulnerabilities",
            "description": "Unlink all the asset vulnerabilities and update asset criticality to Low",
            "arguments": {
                "resource": {
                    "vulnerabilities": "[]"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.assetIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/assets",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "7c09bd19-c688-4f5c-a586-c70f1ec83c53"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "alerts",
                "resources": [
                    "alerts"
                ],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "object",
                            "field": "type",
                            "value": "\/api\/3\/picklists\/6bf60659-76c2-48c4-9171-8c8c16f3b85e",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/6bf60659-76c2-48c4-9171-8c8c16f3b85e",
                                "itemValue": "Vulnerable Asset"
                            },
                            "operator": "eq"
                        },
                        {
                            "type": "object",
                            "field": "state",
                            "value": "",
                            "_value": {
                                "@id": "",
                                "display": "",
                                "itemValue": ""
                            },
                            "operator": "changed"
                        },
                        {
                            "type": "object",
                            "field": "state",
                            "value": "\/api\/3\/picklists\/501d0562-89a0-4079-9a9e-cdde7d34e3ed",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/501d0562-89a0-4079-9a9e-cdde7d34e3ed",
                                "display": "Indicator Extracted",
                                "itemValue": "Indicator Extracted"
                            },
                            "operator": "eq"
                        }
                    ]
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/9300bf69-5063-486d-b3a6-47eb9da24872",
            "group": null,
            "uuid": "a0ab3aa4-242a-4847-982b-fcf3d92bb56d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Close The Alert",
            "description": null,
            "arguments": {
                "resource": {
                    "status": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                    "sourceId": "None",
                    "closureNotes": "{{vars.steps.Confirm_Vulnerability_Status.input.closureNotes}}",
                    "closureReason": "{{vars.steps.Confirm_Vulnerability_Status.input.closureReason}}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.alertIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": [],
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "ba3e3fa6-7331-4b01-b65c-eefba2fd6134"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Manual Input -> Delink Asset Vulnerabilities",
            "targetStep": "\/api\/3\/workflow_steps\/7c09bd19-c688-4f5c-a586-c70f1ec83c53",
            "sourceStep": "\/api\/3\/workflow_steps\/6c240b3d-45e5-476b-a7a2-3a5f976cd391",
            "label": "All Vulnerabilities Resolved",
            "isExecuted": false,
            "group": null,
            "uuid": "4b56dca3-6dc1-4f69-bac4-deff89ff64df"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get Correlated Asset",
            "targetStep": "\/api\/3\/workflow_steps\/7b3cdfe7-78d7-49d2-b55d-e1242bb38c05",
            "sourceStep": "\/api\/3\/workflow_steps\/4c594e1e-9a24-49cd-b625-7f72bc1768f8",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b1748c9f-5278-4d71-b013-008b1f882ef1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/4c594e1e-9a24-49cd-b625-7f72bc1768f8",
            "sourceStep": "\/api\/3\/workflow_steps\/a0ab3aa4-242a-4847-982b-fcf3d92bb56d",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b1f1f364-552d-4505-a5ba-92c828da1795"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Find Assets Linked to Alert -> Confirm Vulnerability Status",
            "targetStep": "\/api\/3\/workflow_steps\/6c240b3d-45e5-476b-a7a2-3a5f976cd391",
            "sourceStep": "\/api\/3\/workflow_steps\/7b3cdfe7-78d7-49d2-b55d-e1242bb38c05",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e07849bb-1a8f-453d-9a2a-1a046e0b3317"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Delink Asset Vulnerabilities -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/ba3e3fa6-7331-4b01-b65c-eefba2fd6134",
            "sourceStep": "\/api\/3\/workflow_steps\/7c09bd19-c688-4f5c-a586-c70f1ec83c53",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f7f970b7-fe5d-46f5-bf80-b4419777b649"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "c95c7f52-32cb-4dd0-acd5-40917b79e9d5",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "PostCreate"
    ]
}