{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Get Vulnerability Details",
    "aliasName": null,
    "tag": "#ManualAction#Vulnerability",
    "description": "Fetch vulnerability information for specified vulnerability",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/d99a8b59-a957-4d95-ac1c-da59ec91a117",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/82ae0cfa-716c-4df1-97bd-7a6e722181bf",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "3b457f8a-6513-4528-a602-5ef1fbb37424",
                "title": "Fetch Vulnerability Information",
                "resources": [
                    "vulnerabilities"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    }
                },
                "displayConditions": {
                    "vulnerabilities": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "group": null,
            "uuid": "82ae0cfa-716c-4df1-97bd-7a6e722181bf"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Vulnerability",
            "description": null,
            "arguments": {
                "resource": {
                    "cvss": "{{vars.risk_info.cvss_base_score}}",
                    "risk": "{{vars.risk_info.risk_factor}}",
                    "cvssVector": "{{vars.risk_info.cvss_vector}}",
                    "pluginName": "{{vars.plugins_info.name}}",
                    "pluginType": "{{vars.plugins_info.type}}",
                    "sourceData": "{{vars.vulnerability_data | toJSON}}",
                    "cvss3Vector": "{{vars.risk_info.cvss3_vector}}",
                    "description": "<table style=\"width: 788px; border-color: #ffffff;\" border=\"1px\" cellspacing=\"10px\" cellpadding=\"10px\"><tbody><tr style=\"height: 35px;\" valign=\"middle\"><td style=\"width: 105px; height: 35px;\" align=\"center\"><span style=\"font-size: 11pt; font-weight: bold;\">Description<\/span><\/td><td style=\"width: 698px; height: 35px;\"><span style=\"font-size: 10pt;\">{{vars.vulnerability_data.description}}<\/span><\/td><\/tr><tr style=\"height: 35px;\" valign=\"middle\"><td style=\"width: 105px; height: 35px;\" align=\"center\"><span style=\"font-size: 11pt; font-weight: bold;\">Synopsis<\/span><\/td><td style=\"width: 698px; height: 19px;\"><span style=\"font-size: 10pt;\">{{vars.vulnerability_data.synopsis}}<\/span><\/td><\/tr><tr style=\"height: 35px;\" valign=\"middle\"><td style=\"width: 105px; height: 35px;\" align=\"center\"><span style=\"font-size: 11pt; font-weight: bold;\">Solution<\/span><\/td><td style=\"width: 698px; height: 31px;\"><span style=\"font-size: 10pt;\">{{vars.vulnerability_data.solution}}<\/span><\/td><\/tr><\/tbody><\/table>",
                    "lastSeenDate": "{{ arrow.get(vars.vulnerability_data.discovery.seen_last).timestamp }}",
                    "pluginFamily": "{{vars.plugins_info.family}}",
                    "firstSeenDate": null,
                    "pluginVersion": "{{vars.plugins_info.version}}",
                    "cvss3BaseScore": "{{vars.risk_info.cvss3_base_score}}",
                    "cvssTemporalScore": "{{vars.risk_info.cvss_temporal_score}}",
                    "cvss3TemporalScore": "{{vars.risk_info.cvss3_temporal_score}}",
                    "cvssTemporalVector": "{{vars.risk_info.cvss_temporal_vector}}",
                    "cvss3TemporalVector": "{{vars.risk_info.cvss3_temporal_score}}",
                    "pluginModificationDate": "{{arrow.get(vars.plugins_info.modification_date).timestamp}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "tagsOperation": "OverwriteTags",
                "collectionType": "\/api\/3\/vulnerabilities",
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "cc94ca8e-2643-4f8a-a102-065626a11daa"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "useMockOutput": "{{globalVars.Demo_mode}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "cf82351f-709a-4738-82ed-56bdaf772546"
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch Vulnerability Information",
            "description": null,
            "arguments": {
                "name": "Tenable.io",
                "config": "0427d980-5772-4609-89d8-85cdcac497a1",
                "params": {
                    "plugin_id": "{{vars.input.records[0].vulnerabilityId}}"
                },
                "version": "1.0.0",
                "connector": "tenable-io",
                "operation": "get_vuln_details",
                "mock_result": "{\n  \"data\": {\n    \"info\": {\n      \"synopsis\": \"An application installed on the remote host is affected by a remote code execution vulnerability.\",\n      \"description\": \"The version of Microsoft Word or Microsoft SharePoint Server installed on the remote Windows host is missing a security update. It is, therefore, affected by a memory corruption issue due to improper handling of objects in memory. An unauthenticated, remote attacker can exploit this, by convincing a user to visit a specially crafted website or open a specially crafted Office file, to execute arbitrary code in the context of the current user.\",\n      \"risk_information\": {\n        \"cvss_base_score\": \"9.3\",\n        \"cvss3_temporal_score\": \"7.7\",\n        \"cvss_vector\": \"AV:N\/AC:M\/Au:N\/C:C\/I:C\/A:C\",\n        \"risk_factor\": \"High\",\n        \"cvss_temporal_score\": \"6.9\",\n        \"stig_severity\": \"II\",\n        \"cvss3_temporal_vector\": \"E:U\/RL:O\/RC:C\",\n        \"cvss_temporal_vector\": \"E:U\/RL:OF\/RC:C\",\n        \"cvss3_base_score\": \"8.8\",\n        \"cvss3_vector\": \"AV:N\/AC:L\/PR:N\/UI:R\/S:U\/C:H\/I:H\/A:H\"\n      },\n      \"see_also\": [\n        \"https:\/\/docs.microsoft.com\/en-us\/security-updates\/SecurityBulletins\/2017\/ms17-002\"\n      ],\n      \"discovery\": {\n        \"seen_last\": \"2019-02-25T06:57:46.820Z\",\n        \"seen_first\": \"2019-01-15T07:05:15.420Z\"\n      },\n      \"plugin_details\": {\n        \"name\": \"MS17-002: Security Update for Microsoft Office (3214291)\",\n        \"modification_date\": \"2018-11-15T00:00:00Z\",\n        \"version\": \"1.8\",\n        \"publication_date\": \"2017-01-10T00:00:00Z\",\n        \"type\": \"local\",\n        \"family\": \"Windows : Microsoft Bulletins\",\n        \"severity\": 3\n      },\n      \"reference_information\": [\n        {\n          \"values\": [\n            \"CVE-2017-0003\"\n          ],\n          \"name\": \"cve\",\n          \"url\": \"http:\/\/web.nvd.nist.gov\/view\/vuln\/detail?vulnId=\"\n        },\n        {\n          \"values\": [\n            \"2017-A-0009\"\n          ],\n          \"name\": \"iava\"\n        },\n        {\n          \"values\": [\n            \"MS17-002\"\n          ],\n          \"name\": \"msft\",\n          \"url\": \"http:\/\/technet.microsoft.com\/en-us\/security\/bulletin\/\"\n        },\n        {\n          \"values\": [\n            \"3128057\",\n            \"3141486\"\n          ],\n          \"name\": \"mskb\"\n        }\n      ],\n      \"count\": 1,\n      \"solution\": \"Microsoft has released a set of patches for Microsoft Word 2016 and SharePoint Server 2016\",\n      \"severity\": 3,\n      \"vuln_count\": 2,\n      \"vulnerability_information\": {\n        \"exploit_available\": false,\n        \"exploited_by_malware\": null,\n        \"in_the_news\": null,\n        \"default_account\": null,\n        \"vulnerability_publication_date\": \"2017-01-10T00:00:00Z\",\n        \"exploited_by_nessus\": null,\n        \"patch_publication_date\": \"2017-01-10T00:00:00Z\",\n        \"cpe\": [\n          \"cpe:\/a:microsoft:office\",\n          \"cpe:\/a:microsoft:sharepoint_server\",\n          \"cpe:\/a:microsoft:word\"\n        ],\n        \"asset_inventory\": null,\n        \"exploitability_ease\": \"No known exploits are available\",\n        \"exploit_frameworks\": [],\n        \"unsupported_by_vendor\": null,\n        \"malware\": null\n      }\n    }\n  },\n  \"status\": \"Success\",\n  \"operation\": \"get_vuln_details\",\n  \"message\": \"\"\n}",
                "operationTitle": "Get Vulnerability Information",
                "step_variables": {
                    "risk_info": "{{vars.result.data.info.risk_information}}",
                    "plugins_info": "{{vars.result.data.info.plugin_details}}",
                    "vulnerability_data": "{{vars.result.data.info}}"
                }
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "dde7856b-b5f5-4b8e-be81-f2bd6992644e"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Fetch Vulnerability Information",
            "targetStep": "\/api\/3\/workflow_steps\/dde7856b-b5f5-4b8e-be81-f2bd6992644e",
            "sourceStep": "\/api\/3\/workflow_steps\/cf82351f-709a-4738-82ed-56bdaf772546",
            "label": null,
            "isExecuted": false,
            "uuid": "20c60db0-0d3e-44f9-bcfd-bca2280fc7dc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch Vulnerability Information -> Update",
            "targetStep": "\/api\/3\/workflow_steps\/cc94ca8e-2643-4f8a-a102-065626a11daa",
            "sourceStep": "\/api\/3\/workflow_steps\/dde7856b-b5f5-4b8e-be81-f2bd6992644e",
            "label": null,
            "isExecuted": false,
            "uuid": "9a78903a-0aa2-4580-925d-291e4864431d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/cf82351f-709a-4738-82ed-56bdaf772546",
            "sourceStep": "\/api\/3\/workflow_steps\/82ae0cfa-716c-4df1-97bd-7a6e722181bf",
            "label": null,
            "isExecuted": false,
            "uuid": "bfe6646e-0e58-455f-bb25-baa518692a6f"
        }
    ],
    "groups": [],
    "priority": null,
    "uuid": "6dd1365e-d44a-4a4f-888b-ed96e27d5328",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "ManualAction",
        "Tenable.io"
    ]
}