{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Create and Link Alerts and Tasks",
    "aliasName": null,
    "tag": null,
    "description": "Creates Alert and Task records for the corresponding high risk Asset and related vulnerabilities",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "assetMetadata"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/d99a8b59-a957-4d95-ac1c-da59ec91a117",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/ef35b807-96fc-40bc-a343-903c3025faac",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "assetIP": "{{vars.input.params.assetMetadata.ip}}",
                "assetIRI": "{{vars.input.params.assetMetadata['@id']}}",
                "assetHostname": "{{vars.input.params.assetMetadata.hostname}}",
                "assetVulnList": "{{vars.input.params.assetMetadata.vulnerabilities}}",
                "assetDeviceUid": "{{vars.input.params.assetMetadata.deviceUid}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "6023ca5e-cdf7-42dc-81f2-a7124c41788d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Alert",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "Asset {{vars.assetHostname}} found at risk",
                    "type": "\/api\/3\/picklists\/574a6ee2-7265-4701-815e-cff83b053bce",
                    "state": "\/api\/3\/picklists\/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "assets": "{{vars.assetIRI}}",
                    "status": "\/api\/3\/picklists\/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "severity": "\/api\/3\/picklists\/40187287-89fc-4e9c-b717-e9443d57eedb",
                    "sourceId": "{{vars.assetDeviceUid}}",
                    "sourceIp": "{{vars.assetIP}}",
                    "__replace": "",
                    "deviceUID": "{{vars.assetDeviceUid}}",
                    "sourcedata": "{{vars.input.params.assetMetadata.sourceData}}",
                    "targetAsset": "{{vars.assetHostname}}",
                    "ackSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                    "respSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                    "priorityWeight": 1,
                    "escalatedtoincident": "\/api\/3\/picklists\/2128a09c-153d-4db3-985d-de6be33deae5",
                    "alertRemainingAckSLA": 0
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/alerts",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "alertIRI": "{{vars.result['@id']}}"
                }
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "805c0e6d-f21e-4841-9cf2-3c122341e547"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Tasks",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.assetVulnList}}",
                    "__bulk": true,
                    "parallel": false,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "name": "{{vars.item.name}}",
                    "alerts": "{{vars.alertIRI}}",
                    "priority": "{{vars.item.severity}}",
                    "__replace": "",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "assignedOnDate": "{{arrow.utcnow().int_timestamp}}",
                    "vulnerabilities": "{{vars.item['@id']}}",
                    "assignedToPerson": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "b971455f-b4d2-429b-b3e3-cc58df9a1263"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "ef35b807-96fc-40bc-a343-903c3025faac"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/6023ca5e-cdf7-42dc-81f2-a7124c41788d",
            "sourceStep": "\/api\/3\/workflow_steps\/ef35b807-96fc-40bc-a343-903c3025faac",
            "label": null,
            "isExecuted": false,
            "uuid": "009219a8-abc9-4802-a17e-255bce7b43ab"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Create Alert",
            "targetStep": "\/api\/3\/workflow_steps\/805c0e6d-f21e-4841-9cf2-3c122341e547",
            "sourceStep": "\/api\/3\/workflow_steps\/6023ca5e-cdf7-42dc-81f2-a7124c41788d",
            "label": null,
            "isExecuted": false,
            "uuid": "3c2b709f-c07a-410f-9011-3e101de519e2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Alert -> Create Tasks",
            "targetStep": "\/api\/3\/workflow_steps\/b971455f-b4d2-429b-b3e3-cc58df9a1263",
            "sourceStep": "\/api\/3\/workflow_steps\/805c0e6d-f21e-4841-9cf2-3c122341e547",
            "label": null,
            "isExecuted": false,
            "uuid": "b912313e-2b6b-42a4-938b-b9c648cced17"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "2b1dfe52-9105-4ed5-a924-c12c235977df",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Referenced"
    ]
}