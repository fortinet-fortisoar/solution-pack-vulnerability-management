{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "JASK - Create or Find Indicator and Comment",
    "aliasName": null,
    "tag": "#JASK, #Signal, #Indicator",
    "description": "Creates or find an indicator and comments from insights",
    "isActive": false,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "indicator",
        "signal_id",
        "signal_name",
        "signal_description"
    ],
    "synchronous": false,
    "lastModifyDate": 1638455643,
    "collection": "\/api\/3\/workflow_collections\/f6e0b44a-74d8-4c28-9d4f-f2ed70fba27d",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/25f84c02-cab4-49dc-8391-744773d5e59c",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Create Indicator",
            "description": null,
            "arguments": {
                "resource": {
                    "tags": null,
                    "hunts": null,
                    "notes": null,
                    "value": "{{ vars.input.params.indicator.value }}",
                    "alerts": null,
                    "assets": null,
                    "emails": null,
                    "events": null,
                    "owners": null,
                    "persons": null,
                    "sources": null,
                    "comments": null,
                    "__replace": "true",
                    "campaigns": null,
                    "companies": null,
                    "evidences": null,
                    "incidents": null,
                    "reputation": null,
                    "attachments": null,
                    "description": null,
                    "indicatorStatus": null,
                    "typeofindicator": "{{ (\"IndicatorType\" | picklist(\"IP Address\"))[\"@id\"] if \" IP\" in vars.input.params.indicator.name else (\"IndicatorType\" | picklist(\"FileHash-MD5\"))[\"@id\"] if vars.input.params.indicator.name == \"MD5\" else (\"IndicatorType\" | picklist(\"FileHash-SHA256\"))[\"@id\"] if vars.input.params.indicator.name == \"SHA256\"  else (\"IndicatorType\" | picklist(\"Domain\"))[\"@id\"] if vars.input.params.indicator.name == \"hostname\" else (\"IndicatorType\" | picklist(\"URL\"))[\"@id\"] if vars.input.params.indicator.name == \"url\" else None}}",
                    "vulnerabilities": null,
                    "correlationGraph": null
                },
                "_showJson": false,
                "collection": "\/api\/3\/upsert\/indicators",
                "step_variables": []
            },
            "status": null,
            "top": "30",
            "left": "450",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "2ef0282c-0c6c-4b67-b781-603c61a32f61",
            "id": 299
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": {
                            "alert_iri": "{{ vars.alert_iri }}",
                            "indicator": "{{ vars.indicator }}",
                            "signal_id": "{{ vars.signal_id }}",
                            "signal_name": "{{ vars.signal_name }}",
                            "signal_description": "{{ vars.signal_description }}"
                        }
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "uuid": "25f84c02-cab4-49dc-8391-744773d5e59c",
            "id": 300
        },
        {
            "@type": "WorkflowStep",
            "name": "Output Record 2",
            "description": null,
            "arguments": {
                "indicator_iri": "{{vars.steps.Create_Indicator['@id']}}"
            },
            "status": null,
            "top": "30",
            "left": "775",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "42798c70-ab06-4437-af38-6b74cfd233d2",
            "id": 301
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Create Indicator -> Output Record 2",
            "targetStep": "\/api\/3\/workflow_steps\/42798c70-ab06-4437-af38-6b74cfd233d2",
            "sourceStep": "\/api\/3\/workflow_steps\/2ef0282c-0c6c-4b67-b781-603c61a32f61",
            "label": null,
            "isExecuted": false,
            "uuid": "b2a23a59-f864-4fcf-a2f7-f024a5b0ade9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Create Indicator",
            "targetStep": "\/api\/3\/workflow_steps\/2ef0282c-0c6c-4b67-b781-603c61a32f61",
            "sourceStep": "\/api\/3\/workflow_steps\/25f84c02-cab4-49dc-8391-744773d5e59c",
            "label": null,
            "isExecuted": false,
            "uuid": "e9b79c83-f4a9-4bb4-bc79-8f2437a4c6ac"
        }
    ],
    "priority": null,
    "uuid": "8d274bbe-0b78-4d0b-be0d-644a766566fa",
    "recordTags": [
        "Subroutine",
        "JASK",
        "JASK - Get Signal Details"
    ],
    "id": 75,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1638454902,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1638455642,
    "owners": [],
    "isPrivate": false
}